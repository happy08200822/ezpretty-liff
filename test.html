<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ezPretty é–‹ç™¼å°å¼•å° (æ»¿å¯¬ä¿®æ­£ç‰ˆ)</title>
  <style>
    /* --- 1. åŸºç¤ä½ˆå±€ --- */
    body { font-family: -apple-system, "Noto Sans TC", sans-serif; background: #f0f2f5; padding: 0; margin: 0; width: 100%; overflow-x: hidden; }
    
    #hud { 
        position: fixed; top: 15px; left: 50%; transform: translateX(-50%) translateY(-150%);
        width: 90%; max-width: 400px; background: linear-gradient(135deg, #FF8008 0%, #FFC837 100%);
        color: white; border-radius: 50px; padding: 8px 15px; display: flex; align-items: center; justify-content: space-between;
        z-index: 11000; box-shadow: 0 10px 25px rgba(255, 128, 8, 0.3); transition: transform 0.5s;
    }
    #hud.show { transform: translateX(-50%) translateY(0); }

    /* --- 2. å½ˆçª—å¼·åˆ¶æ»¿å¯¬ --- */
    .bottom-sheet { 
        position: fixed; bottom: 0; left: 0; right: 0; background: #fff; 
        border-radius: 30px 30px 0 0; z-index: 10000; transform: translateY(100%); transition: transform 0.4s; 
        padding-bottom: 40px; width: 100%; /* å¼·åˆ¶æ»¿å¯¬ */
    }
    .bottom-sheet.show { transform: translateY(0); }

    .sheet-header-box { padding: 15px 20px; border-bottom: 1px solid #eee; text-align: center; position: relative; width: 100%; box-sizing: border-box; }
    .current-store-title { font-size: 20px; font-weight: 900; color: #2c3e50; margin: 0; }
    .sheet-close-btn { position: absolute; right: 15px; top: 15px; font-size: 24px; color: #ccc; cursor: pointer; border: none; background: none; }

    /* --- 3. å°å¼•æ­¥é©Ÿå€åŸŸ --- */
    .guide-scroll-area { padding: 20px; max-height: 80vh; overflow-y: auto; box-sizing: border-box; width: 100%; }
    .guide-container { display: flex; flex-direction: column; gap: 20px; width: 100%; }
    
    .step-box { display: flex; gap: 15px; position: relative; width: 100%; box-sizing: border-box; }
    .step-box:not(:last-child)::after { content: ''; position: absolute; left: 14px; top: 35px; width: 2px; height: calc(100% - 15px); background: #007bff; z-index: 1; }
    .step-box.done:not(:last-child)::after { background: #e0e0e0; }

    .step-num { min-width: 30px; height: 30px; border-radius: 50%; background: #007bff; color: white; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: bold; z-index: 2; }
    .step-box.done .step-num { background: #dcdde1; color: #7f8c8d; }

    .step-content { flex: 1; min-width: 0; width: 100%; }
    .step-title { font-size: 15px; font-weight: bold; color: #555; margin-bottom: 10px; display: block; }

    .btn-main { display: flex; align-items: center; justify-content: center; font-size: 16px; font-weight: bold; color: #fff; background: #007bff; padding: 14px; border-radius: 12px; cursor: pointer; text-decoration: none; width: 100%; border: none; box-sizing: border-box; }
    
    .tag-btn-group { display: flex; gap: 10px; width: 100%; }
    .tag-btn { flex: 1; padding: 12px; background: #fff; border: 1.5px solid #dee2e6; border-radius: 10px; font-weight: bold; cursor: pointer; text-align: center; }
    
    .card-img-box { width: 100%; display: block; }
    .card-img { width: 100%; max-width: 350px; height: auto; border-radius: 10px; border: 1px solid #ddd; cursor: grab; }

    .script-tabs { display: flex; background: #eee; border-radius: 10px; padding: 4px; margin-bottom: 12px; gap: 4px; width: 100%; }
    .tab-btn { flex: 1; padding: 10px; border: none; border-radius: 8px; font-size: 13px; font-weight: bold; cursor: pointer; color: #777; }
    .tab-btn.active { background: #fff; color: #007bff; }
    
    .staff-row { display: none; gap: 8px; margin-bottom: 10px; justify-content: flex-end; }
    .staff-chip { padding: 5px 15px; border-radius: 20px; font-size: 12px; border: 1px solid #007bff; color: #007bff; cursor: pointer; }
    .staff-chip.active { background: #007bff; color: white; }

    .line-textarea { width: 100%; height: 130px; border: 1.5px solid #eee; border-radius: 15px; padding: 15px; font-size: 15px; margin-bottom: 15px; box-sizing: border-box; background: #fafafa; resize: none; }
    
    .btn-final-copy { width: 100%; padding: 18px; border-radius: 15px; border: none; background: #00b894; color: white; font-size: 17px; font-weight: bold; cursor: pointer; box-sizing: border-box; }
    .btn-final-copy.copied { background: #2f3640; }
  </style>
</head>
<body>

  <div id="hud">
      <span>â³ èŠå®Œè¨˜å¾—å›ä¾†æ›´æ–°é€²åº¦ï¼</span>
      <button style="background:none; color:white; border:1px solid white; padding:4px 10px; border-radius:10px;" onclick="closeHUD()">é—œé–‰</button>
  </div>

  <div style="text-align:center; padding-top:100px;">
    <button onclick="openLineModal('æ„›æ´›é›…æ™‚å°šç¾å­¸', 'love_aloya', '0912345678', 'é ç´„ç³»çµ±èˆ‡è–ªè³‡è¨ˆç®—', 'å°ä¸­')" style="padding:15px 30px; border-radius:12px; background:#00C851; color:white; border:none; font-weight:bold; cursor:pointer;">
        ğŸš€ å•Ÿå‹•å°å¼•ä»‹é¢
    </button>
  </div>

  <div class="bottom-sheet" id="lineModal">
      <div class="sheet-header-box">
          <button class="sheet-close-btn" onclick="closeLineModal()">âœ•</button>
          <p class="current-store-title">ğŸ  <span id="displayStoreName">--</span></p>
      </div>

      <div class="guide-scroll-area">
          <div class="guide-container">
              <div class="step-box" id="step1">
                  <div class="step-num">1</div>
                  <div class="step-content">
                      <span class="step-title">é»æ“Š ID åŠ å¥½å‹</span>
                      <a id="lineJumpBtn" href="#" class="btn-main" target="_blank" onclick="markDone(1)">ğŸ†” <span id="lineInfoText">ID</span></a>
                  </div>
              </div>
              <div class="step-box" id="step2">
                  <div class="step-num">2</div>
                  <div class="step-content">
                      <span class="step-title">è¤‡è£½æš±ç¨±</span>
                      <div class="tag-btn-group">
                          <div class="tag-btn" id="tagUser" onclick="copyNick('user'); markDone(2)">ğŸ‘¤ æš±ç¨±</div>
                          <div class="tag-btn" id="tagTeacher" onclick="copyNick('teacher'); markDone(2)">ğŸ§‘â€ğŸ« æš±ç¨±</div>
                      </div>
                  </div>
              </div>
              <div class="step-box" id="step3">
                  <div class="step-num">3</div>
                  <div class="step-content">
                      <span class="step-title">å‚³é€åç‰‡ (é•·æŒ‰æ‹–æ›³è‡³å³è¦–çª—)</span>
                      <div class="card-img-box">
                        <img src="https://happy08200822.github.io/ezpretty-liff/card.jpg" class="card-img" draggable="true" ondragstart="markDone(3)">
                      </div>
                  </div>
              </div>
              <div class="step-box" id="step4">
                  <div class="step-num">4</div>
                  <div class="step-content">
                      <div style="display:flex; justify-content:space-between; align-items:center;">
                        <span class="step-title">è¤‡è£½é–‹ç™¼è©±è¡“</span>
                        <div class="staff-row" id="staffSelector">
                            <div class="staff-chip active" id="chipK" onclick="selectS('Kelvin')">Kelvin</div>
                            <div class="staff-chip" id="chipD" onclick="selectS('David')">David</div>
                        </div>
                      </div>
                      <div class="script-tabs">
                          <button class="tab-btn active" onclick="setS('first')">åˆæ¬¡</button>
                          <button class="tab-btn" onclick="setS('follow')">äºŒæ•²</button>
                          <button class="tab-btn" onclick="setS('success')">é‚€ç´„</button>
                      </div>
                      <textarea id="lineScriptArea" class="line-textarea"></textarea>
                      <button class="btn-final-copy" id="copyBtn" onclick="pureCopy()">ğŸ“‹ åƒ…è¤‡è£½è©±è¡“</button>
                  </div>
              </div>
          </div>
      </div>
  </div>

<script>
    let cur = { name: "", req: "", area: "", staff: "Kelvin", tab: "first" };

    function openLineModal(name, lid, ph, req, area) {
        for(let i=1; i<=4; i++) { document.getElementById(`step${i}`).classList.remove('done'); }
        document.getElementById('displayStoreName').innerText = name;
        cur = { name, req, area, staff: "Kelvin", tab: "first" };
        const idVal = lid !== "--" ? lid : ph;
        document.getElementById('lineInfoText').innerText = idVal;
        document.getElementById('lineJumpBtn').href = `https://line.me/ti/p/~${idVal}`;
        document.getElementById('tagUser').innerText = `ğŸ‘¤ ${name}-`;
        document.getElementById('tagTeacher').innerText = `ğŸ§‘â€ğŸ« ${name}-`;
        setS('first');
        document.getElementById('lineModal').classList.add('show');
    }

    function markDone(step) { document.getElementById(`step${step}`).classList.add('done'); }

    function copyNick(type) {
        const prefix = type === 'user' ? 'ğŸ‘¤' : 'ğŸ§‘â€ğŸ«';
        navigator.clipboard.writeText(`${prefix}${cur.name}-`);
        const id = type === 'user' ? 'tagUser' : 'tagTeacher';
        const old = document.getElementById(id).innerText;
        document.getElementById(id).innerText = "âœ… å·²è¤‡è£½";
        setTimeout(() => { document.getElementById(id).innerText = old; }, 1200);
    }

    function setS(type) {
        cur.tab = type;
        document.getElementById('staffSelector').style.display = (type === 'success') ? 'flex' : 'none';
        const btns = document.querySelectorAll('.tab-btn');
        btns.forEach((b, i) => b.classList.toggle('active', (i===0 && type==='first') || (i===1 && type==='follow') || (i===2 && type==='success')));
        gen();
    }

    function selectS(s) {
        cur.staff = s;
        document.getElementById('chipK').classList.toggle('active', s === 'Kelvin');
        document.getElementById('chipD').classList.toggle('active', s === 'David');
        gen();
    }

    function gen() {
        const { name, req, area, staff, tab } = cur;
        const r = req || "ç›¸é—œ";
        const a = area || "";
        const textarea = document.getElementById('lineScriptArea');
        if (tab === 'first') textarea.value = `å“ˆå›‰ è€é—† æ‚¨å¥½ï¼æ‚¨é€™é‚Šæ˜¯ ${name} åº—å®¶å—ï½\næˆ‘æ˜¯ ezPretty é ç´„ç§‘æŠ€çš„æ¥­å‹™ç¶“ç† æšåº­ ğŸ˜Š\nå‰›æ‰æœ‰æ”¶åˆ°æ‚¨çš„è«®è©¢ï¼Œæ‚¨æƒ³äº†è§£æˆ‘å€‘é ç´„posç³»çµ±çš„ã€${r}ã€‘çš„åŠŸèƒ½å—ï¼Ÿ\n\næ‚¨çœ‹åˆ°è¨Šæ¯å¾Œï¼Œæ–¹ä¾¿è·Ÿæ‚¨é€šè©±1åˆ†é˜å—ï¼Ÿ`;
        else if (tab === 'follow') textarea.value = `å“ˆå›‰è€é—†ï¼Œæ“”å¿ƒæ‚¨è¿‘æ—¥å¿™ç¢Œæ¼æ‰è¨Šæ¯ï¼Œæ‰€ä»¥å†è·Ÿæ‚¨æ‰“å€‹æ‹›å‘¼ ğŸ˜Š\n\nè¿‘æœŸæœ‰æ”¶åˆ°æ‚¨çš„è«®è©¢ï¼Œæ‚¨æƒ³äº†è§£æˆ‘å€‘é ç´„posç³»çµ±çš„ã€${r}ã€‘çš„åŠŸèƒ½å—ï¼Ÿ`;
        else if (tab === 'success') textarea.value = `å¥½çš„ï¼Œæˆ‘å¾…æœƒæ‹‰å€‹ç¾¤çµ„ï¼Œæˆ‘è«‹æˆ‘çš„çµ„å“¡ ${staff} å’Œæ‚¨ç´„æ™‚é–“ä»‹ç´¹ç³»çµ±å”·ï¼\nç¾¤çµ„åç¨±æ˜¯ ã€${a}${name} + ezPrettyè¨è«–ã€\n\næ‚¨å†ç•™æ„ä¸€ä¸‹ç¾¤çµ„çš„è¨Šæ¯å”·ï½`;
    }

    function pureCopy() {
        navigator.clipboard.writeText(document.getElementById('lineScriptArea').value).then(() => {
            markDone(4);
            document.getElementById('hud').classList.add('show');
            const btn = document.getElementById('copyBtn');
            btn.innerText = "âœ… è©±è¡“å·²è¤‡è£½";
            btn.classList.add('copied');
            setTimeout(() => { btn.innerText = "ğŸ“‹ åƒ…è¤‡è£½è©±è¡“"; btn.classList.remove('copied'); }, 2500);
        });
    }

    function closeLineModal() { document.getElementById('lineModal').classList.remove('show'); }
    function closeHUD() { document.getElementById('hud').classList.remove('show'); }
</script>
</body>
</html>
